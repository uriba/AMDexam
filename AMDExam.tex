\documentclass[a4page,notitlepage]{article}
\usepackage{color,soul,amsmath,graphicx}
\usepackage[outercaption]{sidecap}
\usepackage[citestyle=authoryear]{biblatex}
\usepackage[font=small,labelfont=bf]{caption}
\sidecaptionvpos{figure}{c} \providecommand{\abs}[1]{\lvert#1\rvert}
\providecommand{\norm}[1]{\lVert#1\rVert}

\title{Algorithmic Mechanism Design, final exam} \author{Uri
  Barenholz} \date{Febuary 2014}

\begin{document}
\maketitle
\section{Answers}
\begin{enumerate}
\item We start by noting that the expected revenue of OPT is the sum
  of the expected revenue of all of the players, that is:
  \[
  \text{OPT}(S)=\sum_{j=1}^{|S|}E[\text{Revenue}_j]=\sum_{j=1}^{|S|}E[\phi_j(v_j)x_j(\vec{v})]
  \]
  (Where the last equality uses Mayerson's theorem)
\item
  \begin{enumerate}
  \item The algorithm will work as follows, to generate a maximal
    dense allocation do:
    \begin{enumerate}
    \item For each player calculate his density, $d_i=\frac{v_i(s_i)}{s_i}$, requiring $O(n,\log(h),\log(m))$.
    \item Sort the calculated densities in descending order requiring $O(n\log(n))$.
      For players with identical densities, sort them internally by increasing demand.
    \item Iterate on the sorted list, fulfiling the requirement for
      each player (allocating $s_i$ items to the $i$'th player on the sorted list), until reaching the point where not enough items
      remain to fulfil the requirement of the next player, requiring $O(n,\log(m),\log(h))$.
    \end{enumerate}
    This algorithm generates a dense allocation as each player that receives items receivs the exact number of items he is interested in, and he only receives these items if all players with higher density already had their demand satisfied.

    The allocation is \textit{maximum density} as all items (up to the demand of the next-highest density player's demand) have been allocated.
Therefore, every other dense allocation must satisfy the demand for all players up to the last player who's demand was satisfied and therefore does not have enough items left to satisfy the demand of another player in such a way that will not violate the dense requirement.
The special case of being able to satisfy the demand of another player that has identical density to the highest unfulfilled one but with a lower demand is also impossible as the sorted list internally sorted players with identical densities according to their (ascending) demands.

    To generate the welfare maximizing allocation assigning all items to a single player, calculate the welfare generated by assigning all the items to every possible player ($O(n,\log(h))$) and assign all items to the player generating the highest welfare.
    
    Finally, select the highest revenue generating alternative out of
    these two possibilities.
    \item
      Let's observe the maximum density solution generated by the algorithm.
      If it's revenue is more than half of the optimal revenue, we're done.
      
      Otherwise we note that it's revenue is (when the indices are sorted according to the densities): $\sum_{i=1}^kd_is_i<\frac{\text{OPT}}{2}$ (where $k$ is the number of players it was able to satisfy the demand of).
      We now observe the revenue the optimal algorithm (OPT) generates from players ${1,\cdots,k}$ vs. the revenue it generates from the rest of the players.
      Clearly, if most of the optimal revenue is generated by the first $k$ players than the maximum density (which satisfies all of them) generates more than half the revenue of OPT.
      Otherwise, as all the other players have densities smaller than or equal to $d_{k+1}$ whereas all players in the group ${1,\cdots,k}$ have densities higher than or equal to $d_k$, it follows that if more than half the items can be allocated to the group ${1,\cdots,k}$, then that would generate a revenue higher than half of OPT.
      We therefore deduce that the maximum density allocation terminated while having at least half the items still unallocated.
      But that in turn means that $s_{k+1}\geq\frac{m}{2}$.
      Finally, we claim that therefore, allocating all the items to player $k+1$ will generate a revenue higher than half the optimal revenue.
      This is due to the following reason:
      \item
      If player $i$ received $s_i$ the items with $v_i$, then he either received all of the items under the algorithm, or he was one of the $k$ players with the highest densities, whos demand was satisfied by the maximum density allocation.
      If he was one of the $k$ players in the maximum density allocation whos demand was satisfied, then increasing his value only increases his density, and thus the algorithm will still allocate $s_i$ items to him (nothing that this will give superior result than allocating all items to this player as other players will also generate positive revenue in this case).
      If he was given all of the items, then increasing his value will increase the value of this option for the algoritm and may also make him (due to his increased density) a participant in the possible maximum density allocation solution.
      In either case he will still be allocated at least $s_i$ items.
      Explicitly, increasing his value may not cause the algorithm to prefer allocating all items via maximum density to players that do not include him as that would generate the same revenue as when his value was $v_i$, and in that case the algorithm prefered allocating all the items to him.
      
      Thus, to conclude, by the revelation principle, there is a payment function that makes this mechanism truthful.
      \item
        First we note that declaring a \emph{smaller} value of $s_i'<s_i$ increases the valuation (as for all allocations smaller than $s_i'$ the value remains 0, for all allocation larger than $s_i$ the value remains $v_i$ and for all intermediate allocations the value increases from 0 to $v_i$.

        Next we note that decreasing $s_i$ maintains the algorithm's monotonicity as it increases the density and maintains the value of allocating all the items to this player.
        Therefore, if all items were allocated to this player via the algoritm with $s_i$, then decreasin $s_i$ will not cause the algorithm to prefer a maximum density solution that does not include this player (which will have the same value as the maximum density solution with $s_i$) instead of allocating all items to him.
        Thus, in this case, the algorithm will either allocate all items to this player, of satisfy his demand via a maximum density allocation that includes him.

        In case this player's demand was satisfied via a maximum density allocation, increasing his density will only move him 'up' the line in the allocation (not changing his generated revenue, but possibly allowing the demand of more players to be satisfied, thus increasing the revenue generated by the maximum density allocation) and thus, in this case, his demand will still be satisfied by the algorithm.
        
        To conclude, the algorithm is monotone also w.r.t. $s_i$ and therefore a truthful mechanism exists.
        Using VCG will therefore result in a payment function that will make both scenarios truthful.
  \end{enumerate}
\end{enumerate}


\end{document}

